---
title: "燃料项目"
description: ""
icon: ""
date: 2024-09-18
category:
  - 系统设计
tag:
  - 功能设计
---

:::info
这里是我想要实现的需求所阅读的文章
:::

---
### 超时订单自动取消

[程序员大彬](https://topjavaer.cn/advance/system-design/2-order-timeout-auto-cancel.html)
- 方案 1：数据库轮询
- 方案 2：JDK 的延迟队列
- 方案 3：时间轮算法
- 方案 4：redis 缓存
- 方案 5：使用消息队列
- 
[JavaGuide定时任务](https://javaguide.cn/system-design/schedule-task.html)

[博客](https://www.cnblogs.com/dx-2021/p/14845934.html)

我现在做的项目是单机项目，所以打算采用Scheduled和Spring Task 或者 时间论


### 项目设计
#### **用户端**
##### **购物车功能** 
接口设计

- 添加购物车 /shoppingCart/add
- 查看购物车 /shoppingCart/list
- 清空购物车 /shoppingCart/clean
- 删除购物车中的一个商品 /shoppingCart/sub

表设计 shopping_cart

| **字段名**  | **数据类型**  | **说明**     | **备注** |
| ----------- | ------------- | ------------ | -------- |
| id          | bigint        | 主键         | 自增     |
| product_name | varchar(32)   | 商品名称     | 冗余字段 |
| product_image| varchar(255)  | 商品图片路径 | 冗余字段 |
| customer_id  | bigint        | 客户id       | 逻辑外键 |
| product_id   | bigint        | 商品id       | 逻辑外键 |
| number      | int           | 商品数量     |          |
| amount      | decimal(10,2) | 商品单价     | 冗余字段 |
| create_time | datetime      | 创建时间     |          |
| create_user | varchar      | 创建人      |          |
| update_time | datetime     | 更新时间   |          |
| update_user | varchar      | 更新人    |          |
| update_user | varchar      | 更新人    |          |
| org_id      | varchar      | 组织名称  |         |
| org_name | varchar      | 商品描述    |          |

流程图

##### **地址簿功能**

接口设计

- 新增地址 /addressBook/add
- 查询当前登录用户的所有地址信息 /addressBook/list
- 查询默认地址 /addressBook/queryDefault
- 根据id修改地址  /addressBook/edit
- 根据id删除地址  /addressBook/delete
- 根据id查询地址  /addressBook/query
- 设置默认地址  /addressBook/setDefault

表设计

| **字段名**    | **数据类型** | **说明**     | **备注**       |
| ------------- | ------------ | ------------ | -------------- |
| id            | bigint       | 主键         | 自增           |
| user_id       | bigint       | 用户id       | 逻辑外键       |
| consignee     | varchar(50)  | 收货人       |                |
| sex           | varchar(2)   | 性别         |                |
| phone         | varchar(11)  | 手机号       |                |
| province_code | varchar(12)  | 省份编码     |                |
| province_name | varchar(32)  | 省份名称     |                |
| city_code     | varchar(12)  | 城市编码     |                |
| city_name     | varchar(32)  | 城市名称     |                |
| district_code | varchar(12)  | 区县编码     |                |
| district_name | varchar(32)  | 区县名称     |                |
| detail        | varchar(200) | 详细地址信息 | 具体到门牌号   |
| label         | varchar(100) | 标签         | 公司、家、学校 |
| is_default    | tinyint(1)   | 是否默认地址 | 1是 0否        |

流程图

##### **订单功能**

表设计 

orders订单表

| id                      | bigint        | 主键         | 自增                                            |
| ----------------------- | ------------- | ------------ | ----------------------------------------------- |
| number                  | varchar(50)   | 订单号       |                                                 |
| status                  | int           | 订单状态     | 1待付款 2待接单 3已接单 4派送中 5已完成 6已取消 |
| user_id                 | bigint        | 用户id       | 逻辑外键                                        |
| address_book_id         | bigint        | 地址id       | 逻辑外键                                        |
| order_time              | datetime      | 下单时间     |                                                 |
| checkout_time           | datetime      | 付款时间     |                                                 |
| pay_method              | int           | 支付方式     | 1微信支付 2支付宝支付                           |
| pay_status              | tinyint       | 支付状态     | 0未支付 1已支付 2退款                           |
| amount                  | decimal(10,2) | 订单金额     |                                                 |
| remark                  | varchar(100)  | 备注信息     |                                                 |
| phone                   | varchar(11)   | 手机号       | 冗余字段                                        |
| address                 | varchar(255)  | 详细地址信息 | 冗余字段                                        |
| consignee               | varchar(32)   | 收货人       | 冗余字段                                        |
| cancel_reason           | varchar(255)  | 订单取消原因 |                                                 |
| rejection_reason        | varchar(255)  | 拒单原因     |                                                 |
| cancel_time             | datetime      | 订单取消时间 |                                                 |
| estimated_delivery_time | datetime      | 预计送达时间 |                                                 |
| delivery_status         | tinyint       | 配送状态     | 1立即送出 0选择具体时间                         |
| delivery_time           | datetime      | 送达时间     |                                                 |

order_detail订单明细表
| **字段名**  | **数据类型**  | **说明**     | **备注** |
| ----------- | ------------- | ------------ | -------- |
| id          | bigint        | 主键         | 自增     |
| name        | varchar(32)   | 商品名称     | 冗余字段 |
| image       | varchar(255)  | 商品图片路径 | 冗余字段 |
| order_id    | bigint        | 订单id       | 逻辑外键 |
| dish_id     | bigint        | 菜品id       | 逻辑外键 |
| setmeal_id  | bigint        | 套餐id       | 逻辑外键 |
| dish_flavor | varchar(50)   | 菜品口味     |          |
| number      | int           | 商品数量     |          |
| amount      | decimal(10,2) | 商品单价     |          |