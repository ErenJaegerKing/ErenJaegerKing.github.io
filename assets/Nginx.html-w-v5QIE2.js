import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,e as n,o as l}from"./app-DZdpSGPQ.js";const t={};function h(k,s){return l(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_1-nginx部署" tabindex="-1"><a class="header-anchor" href="#_1-nginx部署"><span>1.Nginx部署</span></a></h2><h3 id="nginx部署" tabindex="-1"><a class="header-anchor" href="#nginx部署"><span>Nginx部署</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	1：环境准备</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		pcre-devel，C语言库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		zlib-devel，支持图文压缩，便于传输</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		gcc，gcc-c++，c和c++编译器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		nginx二进制源码包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	2：安装前检查</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      检查软件包仓库是否能用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pcre-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zlib-devel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 安装pcre，zlib软件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-c++</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	3：安装nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		解压到指定目录位置/opt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-1.12.2.tar.gz</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  解压到当前目录（在/opt下面直接使用）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建管理nginx用户</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   useradd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sbin/nologin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		cd进入到nginx目录中进行编译安装</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				./configure</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-prefix=/usr/local/nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-user=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-group=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-with-http_stub_status_module</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			编译</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				make</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			安装</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		命令优化，便于系统识别直接使用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/sbin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		启动服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		检查服务开启</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ntap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				看到80端口开启，则nginx服务处于运行状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		清空防火墙规则，让网站可以被外界访问</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> firewalld.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		使用URL访问网站服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			http://服务器IP/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	管理</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		开启服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		关闭服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			killall</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		重启服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			killall</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		检查配置文件语法</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建管理文件到指定为止</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/init.d/nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		使用系统服务管理工具service管理nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			管理脚本</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				#!/bin/bash# chkconfig: - 99 20# description: Nginx Service Control ScriptPROG=&quot;/usr/local/nginx/sbin/nginx&quot;PIDF=&quot;/usr/local/nginx/logs/nginx.pid&quot;case &quot;$1&quot; instart)$PROG;;stop)kill -s QUIT $(cat $PIDF);;restart)$0 stop$0 start;;reload)kill -s HUP $(cat $PIDF);;*)echo &quot;Usage: $0 {start|stop|restart|reload}&quot;exit 1esacexit 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			赋予脚本执行权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/init.d/nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			把nginx服务添加到管理工具中</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chkconfig</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chkconfig</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  查看是否添加成功</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chkconfig</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --level</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 35</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  在字符和图形化界面模式登录自动开启服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		日志</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			访问日志</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				/usr/local/nginx/logs/access.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			错误日志</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				/usr/local/nginx/logs/error.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		配置文件备份</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.conf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.conf.bk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;#&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.conf.bk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		统计访问数量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			修改nginx.conf配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {stub_status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">access_log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			重启nginx服务</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop，service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			访问路径http://服务ip/status</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		身份验证访问</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			网页身份验证工具</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> httpd-tools</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			创建访问用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				htpasswd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/passwd.db</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jerry</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			设置用户文件权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chown</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/passwd.db</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 400</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd.db</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置文件修改</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {auth_basic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;secret&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">auth_basic_user_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/passwd.db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			重启服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		访问控制</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置文件中加入</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				deny</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 192.168.100.132</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allow</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="dns服务" tabindex="-1"><a class="header-anchor" href="#dns服务"><span>DNS服务</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	安装软件包bind</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bind</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		主配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/named.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			listen-on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> port</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 53</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> any</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; };  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">允许所有地址访问</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		区域配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/named.rfc1912.zones</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			zone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;jky.com&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;jky.com.zone&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> named.localhost</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jky.com.zone</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		区域数据配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jky.com.zone</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">			$TTL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1D@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SOA</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  @</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> admin.jky.com.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0       ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">serial1D</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">refresh1H</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">retry1W</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">expire3H</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> )    ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">minimumNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      @A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       127.0.0.1www</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  A</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       192.168.100.128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	启动服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> named</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	使用客户端解析</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		nslookup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> www.jky.com</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="nginx虚拟主机" tabindex="-1"><a class="header-anchor" href="#nginx虚拟主机"><span>nginx虚拟主机</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	修改配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {server_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  www.jky.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /var/www/jky</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.php</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	创建网站站点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /var/www/jky</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	创建首页</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/www/jky/index.html</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	重启nginx服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	创建第2个网站</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		添加域名解析www.xykj.com</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		配置区域文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/named.rfc1912.zones</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			zone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;xykj.com&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;xykj.com.zone&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		生成对应区域数据文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jky.com.zone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xykj.com.zone</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">			$TTL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1D@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SOA</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  @</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> admin.xykj.com.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0       ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">serial1D</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">refresh1H</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">retry1W</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">expire3H</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> )    ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">minimumNS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      @A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       127.0.0.1www</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  A</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       192.168.100.128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		重启域名服务器</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> named</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		修改nginx配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {server_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  www.xykj.com</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /var/www/xykj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.php</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建站点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/www/xykj</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.html</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		重启nginx服务</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-nginx-tomcat动静分离" tabindex="-1"><a class="header-anchor" href="#_2-nginx-tomcat动静分离"><span>2.Nginx+Tomcat动静分离</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	nginx部署</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		nginx安装部署</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			环境部署需要安装pcre，zlib，gcc，gcc-c++</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			创建用户</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> useradd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sbin/nologin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			解压软件包</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx1.12</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /user/local</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				./configure</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-prefix=/usr/local/nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-user=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-group=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-with-http_stub_status_module</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			编译和安装</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			创建快捷方式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/sbin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			便于service管理</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/init.d/nginx</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				#!/bin/bash# chkconfig: - 99 20# description: Nginx Service Control ScriptPROG=&quot;/usr/local/nginx/sbin/nginx&quot;PIDF=&quot;/usr/local/nginx/logs/nginx.pid&quot;case &quot;$1&quot; instart)$PROG;;stop)kill -s QUIT $(cat $PIDF);;restart)$0 stop$0 start;;reload)kill -s HUP $(cat $PIDF);;*)echo &quot;Usage: $0 {start|stop|restart|reload}&quot;exit 1esacexit 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				赋予权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">					chmod</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/init.d/nginxchkconfig</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			启动nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		清空防火墙规则</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			iptables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	Tomcat部署</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		安装jdk环境</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jdk-8u91-linux-x64.tar.gz</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置环境变量</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">			export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jdk1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">0_91export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JRE_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jreexport</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CLASSPATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JRE_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libexport</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PATH</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置生效</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			检查Java版本</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> java</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -version</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		安装Tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			解压软件包</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.16.tar.gz</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			重命名目录便于操作</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.16/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			建立快捷方式便于Tomcat启动和关闭</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/bin/startup.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/bin/shutdown.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			启动Tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				startup.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			检查是否开启</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ntap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	动静分离配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		nginx地址：192.168.100.129/24</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		Tomcat地址：192.168.100.128/24</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		对于Java文件动态请求转发到Tomcat服务中处理</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			nginx服务器中配置nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.jsp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://192.168.100.128:8080</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">proxy_set_header</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Host</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建静态页面</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/html/index.html</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">DOCTYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">meta</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http-equiv=&quot;content-type&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> content=&quot;text/html;charset=utf-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">静态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">bod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">静态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/h</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt;&lt;p&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">这是个静态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">p&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/bod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		重启nginx服务</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		静态页面呈现</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			子主题</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		动态请求配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			在Tomcat服务器中操作</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			创建动态页面站点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/webapps/test</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				动态页面</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.jsp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">DOCTYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">%@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> language=&quot;java&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> contentType=&quot;text/html; charset=UTF-8&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pageEncoding=&quot;UTF-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">%&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">%@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> import=&quot;java.util.Date&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> %&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">%@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> import=&quot;java.text.SimpleDateFormat&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> %&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">!DOCTYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PUBLIC</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;http://www.w3.org/TR/ html4/loose.dtd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">meta</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http-equiv=&quot;Content-Type&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> content=&quot;text/html; charset=UTF-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">动态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">bod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">di</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">v&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">动态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/di</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">v&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/bod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			清空Tomcat服务器中防火墙规则</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				iptables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		原理图</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			子主题</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		图片动静分离处理</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			Tomcat服务器中操作，添加页面路径</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.jsp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">动态页面</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/title&gt;&lt;br&gt;&lt;img </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">src=&quot;fish.jpg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			nginx服务器中操作</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				自动识别处理图片配置nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gif</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jpg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">jpeg</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">png</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">swf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">css</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)$ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">expires</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			tomcat和nginx站点路径保持一致</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/html/test</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			图片放置到nginx服务器的test目录中</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			重启Tomcat服务器</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-nginx负载均衡" tabindex="-1"><a class="header-anchor" href="#_3-nginx负载均衡"><span>3.Nginx负载均衡</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx负载均衡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	部署Tomcat01</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		防火墙规则清空</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			iptables</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			setenforce</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		部署Java环境</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			安装jdk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> jdk-8u91-linux-x64.tar.gz</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			添加Java环境变量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">				export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JAVA_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">local</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jdk1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">0_91export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> JRE_HOME</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jreexport</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> CLASSPATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JRE_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libexport</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">JAVA_HOME</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PATH</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">				source</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		安装Tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			解压软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				tar</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.16.tar.gz</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			重命名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apache-tomcat-8.5.16/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			优化启动命令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/bin/startup.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			优化关闭命令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/bin/shutdown.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		启动Tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			startup.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		检查端口是否正常运行</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			netstat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ntap</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8080</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		配置站点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			创建站点目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -pv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /web/webapp1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				创建首页</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">					vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.jsp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				内容</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">					&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">%@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> language=&quot;java&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> import=&quot;java.util.*&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pageEncoding=&quot;UTF-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">%&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">JSP</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/titl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/hea</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">bod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out.println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;Welcome 幸云科技 web01&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/body&gt;&lt;/html&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			配置Tomcat识别站点目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/tomcat/conf/server.xml</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Context</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> docBase=&quot;/web/webapp1&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path=&quot;&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reloadable=&quot;false&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/Contex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		重启Tomcat</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			shutdown.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			startup.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	nginx反向代理配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		环境配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pcre-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zlib-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-c++</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建程序用户</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			useradd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sbin/nologin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		解压软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-1.12.0.tar.gz</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		配置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			./configure</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-prefix=/usr/local/nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-user=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-group=nginx</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-with-http_stub_status_module</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-with-http_gzip_static_module</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-with-http_flv_module</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			make</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/conf/nginx.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		服务池名为tomcat_server</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			upstream</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tomcat_server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.100.136:8080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> weight=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.100.138:8080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> weight=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		配置站点转发</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			location</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> {root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  index.html</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index.htm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">proxy_pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://tomcat_server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		启动nginx服务</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-论坛部署" tabindex="-1"><a class="header-anchor" href="#_4-论坛部署"><span>4.论坛部署</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">论坛部署</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		进入数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 密码abc123</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		创建论坛数据库bbs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> database</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bbs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		提权bbsuser用户从外面任意终端访问bbs数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grant</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bbs.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;bbsuser&#39;@&#39;%&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identified</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;admin123&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		提权bbsuser用户从本地服务器访问bbs数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">grant</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bbs.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;bbsuser&#39;@&#39;localhost&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identified</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;admin123&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		权限刷新，及时生效</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">flush</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> privileges</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		测试数据库连接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/html/index.php</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">?php$link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=mysqli_connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;192.168.100.129&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;bbsuser&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;admin123&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);if(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&lt;h1&gt;Success!!&lt;/h1&gt;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Fail!!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;?&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	安装论坛</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		解压软件包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			unzip</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Discuz_X3.4_SC_UTF8.zip</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		拷贝安装目录到nginx站点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> upload/</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/html/bbs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		赋予制定目录nginx属主和属组权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root:nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./config/chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root:nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./data/chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root:nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./uc_client/chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root:nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./uc_server/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		赋予制定目录nginx读写权限</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 777</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./config/chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 777</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./data/chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 777</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./uc_client/chmod</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 777</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ./uc_server/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		设置网站和数据库管理员账号及密码</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">			子主题</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13)]))}const d=i(t,[["render",h],["__file","Nginx.html.vue"]]),r=JSON.parse('{"path":"/notes/devops/b_DeployConfiguration/Nginx.html","title":"Nginx","lang":"zh-CN","frontmatter":{"title":"Nginx","description":"1.Nginx部署 Nginx部署 DNS服务 nginx虚拟主机 2.Nginx+Tomcat动静分离 3.Nginx负载均衡 4.论坛部署","icon":"","date":"2024-09-21T00:00:00.000Z","category":["运维"],"tag":["Nginx"],"head":[["meta",{"property":"og:url","content":"https://he9.xin/notes/devops/b_DeployConfiguration/Nginx.html"}],["meta",{"property":"og:site_name","content":"春风不语即随本心"}],["meta",{"property":"og:title","content":"Nginx"}],["meta",{"property":"og:description","content":"1.Nginx部署 Nginx部署 DNS服务 nginx虚拟主机 2.Nginx+Tomcat动静分离 3.Nginx负载均衡 4.论坛部署"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-27T14:28:57.000Z"}],["meta",{"property":"article:author","content":"ErenJaegerKing"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:published_time","content":"2024-09-21T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-27T14:28:57.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-09-21T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-27T14:28:57.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ErenJaegerKing\\",\\"url\\":\\"https://he9.xin\\",\\"email\\":\\"erenjaegerking@qq.com\\"}]}"]]},"headers":[{"level":2,"title":"1.Nginx部署","slug":"_1-nginx部署","link":"#_1-nginx部署","children":[{"level":3,"title":"Nginx部署","slug":"nginx部署","link":"#nginx部署","children":[]},{"level":3,"title":"DNS服务","slug":"dns服务","link":"#dns服务","children":[]},{"level":3,"title":"nginx虚拟主机","slug":"nginx虚拟主机","link":"#nginx虚拟主机","children":[]}]},{"level":2,"title":"2.Nginx+Tomcat动静分离","slug":"_2-nginx-tomcat动静分离","link":"#_2-nginx-tomcat动静分离","children":[]},{"level":2,"title":"3.Nginx负载均衡","slug":"_3-nginx负载均衡","link":"#_3-nginx负载均衡","children":[]},{"level":2,"title":"4.论坛部署","slug":"_4-论坛部署","link":"#_4-论坛部署","children":[]}],"git":{"createdTime":1726479982000,"updatedTime":1732717737000,"contributors":[{"name":"LiYaoYu","email":"ErenJaegerKing@qq.com","commits":1}]},"readingTime":{"minutes":6.46,"words":1938},"filePathRelative":"notes/devops/b_DeployConfiguration/Nginx.md","localizedDate":"2024年9月21日","excerpt":"<h2>1.Nginx部署</h2>\\n<h3>Nginx部署</h3>\\n<div class=\\"language-shell line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"shell\\" data-title=\\"shell\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t1：环境准备</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tpcre-devel，C语言库</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tzlib-devel，支持图文压缩，便于传输</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tgcc，gcc-c++，c和c++编译器</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tnginx二进制源码包</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t2：安装前检查</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tyum</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> list</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">      检查软件包仓库是否能用</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tyum</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> pcre-devel</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> zlib-devel</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -y</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 安装pcre，zlib软件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tyum</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> gcc</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> gcc-c++</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -y</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t3：安装nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t解压到指定目录位置/opt</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\ttar</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> zxvf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx-1.12.2.tar.gz</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  解压到当前目录（在/opt下面直接使用）</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t创建管理nginx用户</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">   useradd</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -M</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -s</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /sbin/nologin</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\tcd进入到nginx目录中进行编译安装</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t配置</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\t./configure</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\"> \\\\-</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">-prefix=/usr/local/nginx</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\"> \\\\-</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">-user=nginx</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\"> \\\\-</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">-group=nginx</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\"> \\\\-</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">-with-http_stub_status_module</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t编译</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tmake</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t安装</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tmake</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t命令优化，便于系统识别直接使用</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tln</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -s</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/local/nginx/sbin/nginx</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/local/sbin/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t启动服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tnginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t检查服务开启</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tnetstat</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -ntap</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">grep</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\t看到80端口开启，则nginx服务处于运行状态</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t清空防火墙规则，让网站可以被外界访问</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tsystemctl</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> stop</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> firewalld.service</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tsetenforce</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 0</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t使用URL访问网站服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\thttp://服务器IP/</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t管理</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t开启服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tnginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t关闭服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tkillall</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -3</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t重启服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tkillall</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -1</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t检查配置文件语法</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tnginx</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -t</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t创建管理文件到指定为止</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tvim</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/init.d/nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t使用系统服务管理工具service管理nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t管理脚本</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">\\t\\t\\t\\t#!/bin/bash# chkconfig: - 99 20# description: Nginx Service Control ScriptPROG=\\"/usr/local/nginx/sbin/nginx\\"PIDF=\\"/usr/local/nginx/logs/nginx.pid\\"case \\"$1\\" instart)$PROG;;stop)kill -s QUIT $(cat $PIDF);;restart)$0 stop$0 start;;reload)kill -s HUP $(cat $PIDF);;*)echo \\"Usage: $0 {start|stop|restart|reload}\\"exit 1esacexit 0</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t赋予脚本执行权限</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchmod</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> +x</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /etc/init.d/nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t把nginx服务添加到管理工具中</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchkconfig</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --add</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchkconfig</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --list</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  查看是否添加成功</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchkconfig</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --level</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 35</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> on</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  在字符和图形化界面模式登录自动开启服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t日志</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t访问日志</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\t/usr/local/nginx/logs/access.log</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t错误日志</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\t/usr/local/nginx/logs/error.log</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t配置文件备份</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tmv</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx.conf</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx.conf.bk</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\tgrep</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -v</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"#\\"</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx.conf.bk</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> &gt; </span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">nginx.conf</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t统计访问数量</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t修改nginx.conf配置文件</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tlocation</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> ~</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /status</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> {stub_status</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">   on</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">access_log</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> off</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;}</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t重启nginx服务</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> service</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> stop，service</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> start</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t访问路径http://服务ip/status</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t身份验证访问</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t网页身份验证工具</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">   yum</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> httpd-tools</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -y</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t创建访问用户</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\thtpasswd</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -c</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/local/nginx/passwd.db</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> jerry</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t设置用户文件权限</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchown</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/local/nginx/passwd.db</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tchmod</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 400</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> passwd.db</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t配置文件修改</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tlocation</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> {auth_basic</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"secret\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">auth_basic_user_file</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> /usr/local/nginx/passwd.db</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">root</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">   html</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">index</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">  index.html</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> index.htm</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;}</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t重启服务</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t访问控制</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t配置文件中加入</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">\\t\\t\\t\\tdeny</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> 192.168.100.132</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">allow</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> all</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{d as comp,r as data};
